(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],{20:function(e,t,n){e.exports=n(39)},25:function(e,t,n){},26:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(11),o=n.n(r),i=(n(25),n(19)),c=n(3),u=n(4),l=n(7),m=n(6),h=n(5),g=(n(26),n(8)),p=n(9),d=n(2),f=Object(d.b)((function(e){return{user:e.user}}),(function(e){return{openChangeUserWindow:function(){return e({type:"OPEN_WINDOW_TO_CHANGE_USER_NAME"})}}}))((function(e){return s.a.createElement("header",{className:"App-header"},s.a.createElement("h1",null,"CHAT"),s.a.createElement("div",{className:"header-user-container"},s.a.createElement("p",{className:"header-user-username"},e.user),s.a.createElement("div",{className:"header-user-icon"},s.a.createElement(g.a,{onClick:e.openChangeUserWindow,icon:p.c,size:"2x"}))))})),E=(n(34),n(35),function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"scrollToBottom",value:function(){var e=this.messageListDiv.scrollHeight-this.messageListDiv.clientHeight;this.messageListDiv.scrollTop=e>0?e:0}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"main-messagelist-container",ref:function(t){e.messageListDiv=t}},s.a.createElement("ul",null,this.props.messagesList.map((function(e,t){return s.a.createElement("li",{key:t,className:"messagelist-item"},s.a.createElement("p",{className:"messagelist-user"},e.from),s.a.createElement("p",{className:"messagelist-time"},new Date(e.time).toLocaleString("en",{month:"long",day:"numeric",hour:"numeric",hourCycle:"h23",minute:"numeric"})),s.a.createElement("p",{className:"messagelist-text"},e.message))}))))}}]),n}(s.a.Component)),S=Object(d.b)((function(e){return{messagesList:e.messagesList,user:e.user}}),{})(E),T=(n(36),function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleChange=a.handleChange.bind(Object(l.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"handleChange",value:function(e){this.props.currentTextOfMessageToSend(e.target.value),e.preventDefault()}},{key:"handleSubmit",value:function(e){this.props.onTextMessageToSend(this.props.currentTextOfMessageToSend),e.preventDefault()}},{key:"render",value:function(){return s.a.createElement("form",{className:"main-messageinput-container",onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",value:this.props.fromStateCurrentTextOfMessageToSend,placeholder:"Type your message here",onChange:this.handleChange}),s.a.createElement("button",{type:"submit"},s.a.createElement(g.a,{icon:p.a})))}}]),n}(s.a.Component)),O=Object(d.b)((function(e){return{fromStateCurrentTextOfMessageToSend:e.currentTextOfMessageToSend}}),(function(e){return{currentTextOfMessageToSend:function(t){return e({type:"UPDATE_MESSAGE_TEXT_TO_SEND",currentTextOfMessageToSend:t})}}}))(T),N=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){return Object(c.a)(this,n),t.call(this,e)}return Object(u.a)(n,[{key:"render",value:function(){return s.a.createElement("main",{className:"App-main"},s.a.createElement(S,null),s.a.createElement(O,{onTextMessageToSend:this.props.onTextMessageToSend}))}}]),n}(s.a.Component),b=(n(37),function(){return s.a.createElement("footer",{className:"App-footer"},s.a.createElement("p",null,"RS School Task"))}),_=(n(38),function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={newUserName:""},a.handleSubmit=a.handleSubmit.bind(Object(l.a)(a)),a.handleChange=a.handleChange.bind(Object(l.a)(a)),a}return Object(u.a)(n,[{key:"handleSubmit",value:function(e){e.preventDefault(),""!==this.state.newUserName&&(this.props.changeUserName(this.state.newUserName),localStorage.setItem("RSChatUser",JSON.stringify(this.state.newUserName)),this.setState({newUserName:""})),this.props.closeChangeUserWindow()}},{key:"handleChange",value:function(e){this.setState({newUserName:e.target.value})}},{key:"render",value:function(){return s.a.createElement("header",{className:"App-changeuser ".concat(this.props.isOpenWindowToChangeUserName?"open":"")},s.a.createElement("button",{className:"changeuser-button-close",onClick:this.props.closeChangeUserWindow},s.a.createElement(g.a,{icon:p.b,size:"2x"})),s.a.createElement("h2",null,"".concat("Anonymus"===this.props.user?"Set":"Change"," User Name")),s.a.createElement("div",{className:"changeuser-user-icon"},s.a.createElement(g.a,{icon:p.c,size:"4x"})),s.a.createElement("p",{className:"changeuser-user-name"},this.props.user),s.a.createElement("form",{className:"changeuser-form",onSubmit:this.handleSubmit},s.a.createElement("input",{type:"text",placeholder:"Type new user name",onChange:this.handleChange}),s.a.createElement("button",{type:"submit"},"Change")))}}]),n}(s.a.Component)),C=Object(d.b)((function(e){return{isOpenWindowToChangeUserName:e.isOpenWindowToChangeUserName,user:e.user}}),(function(e){return{changeUserName:function(t){return e({type:"CHANGE_USER_NAME",user:t})},closeChangeUserWindow:function(){return e({type:"CLOSE_WINDOW_TO_CHANGE_USER_NAME"})}}}))(_),v=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleTextMessageToSend=a.handleTextMessageToSend.bind(Object(l.a)(a)),a.ws=new WebSocket("ws://st-chat.shas.tel"),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;if(localStorage.getItem("RSChatUser")&&"undefined"!==localStorage.getItem("RSChatUser")){var t=JSON.parse(localStorage.getItem("RSChatUser"));this.props.changeUserName(t)}else this.props.openChangeUserWindow();this.ws.onopen=function(e){if("granted"===Notification.permission)new Notification("RS School CHAT",{body:"Notifications active"});else"denied"!==Notification.permission&&Notification.requestPermission().then((function(e){if("granted"===e)new Notification("RS School CHAT",{body:"Notifications active"})}))},this.ws.onmessage=function(t){var n=JSON.parse(t.data);document.hidden&&"granted"===Notification.permission&&n.map((function(e){return new Notification("RS School CHAT",{body:"".concat(e.from,": ").concat(e.message)})})),n.reverse();var a=Object(i.a)(e.props.messagesList);n.map((function(e){return a.push(e)})),e.props.updateMessagesList(a)},this.ws.onclose=function(e){console.log("CLOSE",e)}}},{key:"handleTextMessageToSend",value:function(){var e={from:this.props.user,message:this.props.fromStateCurrentTextOfMessageToSend};this.ws.send(JSON.stringify(e)),this.props.currentTextOfMessageToSend("")}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(f,null),s.a.createElement(N,{onTextMessageToSend:this.handleTextMessageToSend}),s.a.createElement(b,null),s.a.createElement(C,null))}}]),n}(s.a.Component),w=Object(d.b)((function(e){return{changeUserWindowOpen:e.isOpenWindowToChangeUserName,user:e.user,fromStateCurrentTextOfMessageToSend:e.currentTextOfMessageToSend,messagesList:e.messagesList}}),(function(e){return{changeUserName:function(t){return e({type:"CHANGE_USER_NAME",user:t})},openChangeUserWindow:function(){return e({type:"OPEN_WINDOW_TO_CHANGE_USER_NAME"})},currentTextOfMessageToSend:function(t){return e({type:"UPDATE_MESSAGE_TEXT_TO_SEND",currentTextOfMessageToSend:t})},updateMessagesList:function(t){return e({type:"UPDATE_MESSAGES_LIST",messagesList:t})}}}))(v);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var U=n(12);var y=Object(U.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isOpenWindowToChangeUserName:!1,user:"Anonymus",currentTextOfMessageToSend:"",messagesList:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"OPEN_WINDOW_TO_CHANGE_USER_NAME":return Object.assign({},e,{isOpenWindowToChangeUserName:!0});case"CLOSE_WINDOW_TO_CHANGE_USER_NAME":return Object.assign({},e,{isOpenWindowToChangeUserName:!1});case"CHANGE_USER_NAME":return Object.assign({},e,{user:t.user});case"UPDATE_MESSAGE_TEXT_TO_SEND":return Object.assign({},e,{currentTextOfMessageToSend:t.currentTextOfMessageToSend});case"UPDATE_MESSAGES_LIST":return Object.assign({},e,{messagesList:t.messagesList});default:return e}}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());o.a.render(s.a.createElement(d.a,{store:y},s.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.ea57ca08.chunk.js.map